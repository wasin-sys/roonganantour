<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roong Anar Tour - Document System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ci: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
            background-color: #f3f4f6;
        }
        
        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        .sidebar {
            width: 280px;
            background-color: #0c4a6e;
            color: white;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            z-index: 50;
        }
        .main-content {
            flex: 1;
            overflow-y: auto;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .a4-container {
            width: 210mm;
            min-height: 297mm;
            background-color: white;
            padding: 40px;
            padding-bottom: 60px;
            position: relative;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }
        
        .content-wrapper {
            flex: 1;
        }

        .menu-item.active {
            background-color: #0ea5e9;
            font-weight: bold;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .checkbox-box {
            width: 16px;
            height: 16px;
            border: 1px solid #9ca3af;
            border-radius: 2px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
        }
        .checkbox-box.checked {
            background-color: #0284c7;
            border-color: #0284c7;
            color: white;
        }

        .doc-type-label {
            display: inline-block;
            font-size: 14px;
            font-weight: 500;
            color: #64748b;
            margin-bottom: 8px;
            border: none;
            background: none;
            padding: 0;
        }

        @media print {
            body, .main-content {
                background-color: white;
                margin: 0;
                padding: 0;
                height: auto;
                overflow: visible;
                display: block;
            }
            .app-container {
                display: block;
                height: auto;
            }
            .sidebar {
                display: none !important;
            }
            .a4-container {
                width: 100%;
                box-shadow: none;
                padding: 30px;
                margin: 0;
                border: none;
                min-height: auto;
                page-break-after: always;
            }
            .a4-container:last-child {
                page-break-after: auto;
            }
            button {
                display: none !important;
            }
            .main-content {
                gap: 0;
            }
        }
    </style>
</head>
<body>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar p-6 shadow-2xl">
            <div class="flex items-center gap-3 mb-10 pb-6 border-b border-ci-800">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center text-ci-600 text-lg shadow-inner">
                    <i class="fas fa-sailboat"></i>
                </div>
                <div>
                    <h1 class="font-bold text-lg leading-tight tracking-wide">ROONG A NAN</h1>
                    <p class="text-[10px] text-ci-100 opacity-70 uppercase tracking-widest">Document System</p>
                </div>
            </div>

            <nav class="space-y-3 flex-1">
                <p class="text-[10px] font-bold text-ci-400 uppercase mb-2 tracking-wider px-3">เลือกประเภทเอกสาร</p>
                
                <button onclick="switchDoc('billing')" id="btn-billing" class="menu-item w-full text-left py-3 px-4 rounded-lg flex items-center gap-3 hover:bg-ci-800 transition-all active">
                    <i class="fas fa-file-invoice w-5 text-center"></i>
                    <span>ใบวางบิล</span>
                </button>

                <button onclick="switchDoc('voucher')" id="btn-voucher" class="menu-item w-full text-left py-3 px-4 rounded-lg flex items-center gap-3 hover:bg-ci-800 transition-all">
                    <i class="fas fa-money-bill-wave w-5 text-center"></i>
                    <span>ใบสำคัญรับเงิน</span>
                </button>

                <button onclick="switchDoc('receipt')" id="btn-receipt" class="menu-item w-full text-left py-3 px-4 rounded-lg flex items-center gap-3 hover:bg-ci-800 transition-all">
                    <i class="fas fa-receipt w-5 text-center"></i>
                    <span>ใบเสร็จรับเงิน</span>
                </button>
            </nav>

            <div class="mt-auto pt-6 border-t border-ci-800">
                <button onclick="printDocument()" class="w-full bg-white text-ci-900 hover:bg-ci-50 font-bold py-3 px-4 rounded-lg shadow-lg transition-all flex items-center justify-center gap-2 transform hover:scale-[1.02]">
                    <i class="fas fa-print"></i> 
                    <span>พิมพ์ / บันทึก PDF</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="print-area">
            
            <!-- MASTER PAGE (Original) -->
            <div class="a4-container" id="master-page">
                <div class="content-wrapper">
                    <!-- Header -->
                    <div class="flex justify-between items-start border-b-2 border-ci-900 pb-6 mb-6">
                        <div class="flex gap-4">
                            <div class="w-20 h-20 bg-white border-2 border-ci-500 rounded-full flex items-center justify-center text-ci-500 text-3xl shadow-sm relative overflow-hidden">
                                <i class="fas fa-sailboat relative z-10 ml-1 mt-1"></i> 
                                <div class="absolute top-0 right-0 w-12 h-12 bg-ci-100 rounded-full -mr-2 -mt-2 z-0"></div>
                            </div>
                            <div class="pt-1">
                                <h1 class="text-xl font-bold text-ci-800 uppercase tracking-wide leading-tight">ROONG A NAN TOUR</h1>
                                <h2 class="text-lg font-bold text-ci-600">บจก. รุ่งอนันต์ ทัวร์</h2>
                                <p class="text-xs font-bold text-ci-800 mt-0.5 tracking-wider">NO 21/00645</p>
                                <div class="text-xs text-gray-600 mt-2 space-y-0.5">
                                    <p>123/45 ถนนพหลโยธิน แขวงลาดยาว เขตจตุจักร กรุงเทพฯ 10900</p>
                                    <p><span class="font-semibold">เลขประจำตัวผู้เสียภาษี:</span> 0105566012345</p>
                                </div>
                            </div>
                        </div>
                        <div class="text-right flex flex-col items-end pt-1">
                            <h2 class="doc-title text-3xl font-bold text-ci-900 mb-1">ใบวางบิล</h2>
                            
                            <!-- LABEL: Plain text style -->
                            <span class="doc-type-label">ต้นฉบับ (Original)</span>
                            
                            <div class="grid grid-cols-[auto_auto] gap-x-3 gap-y-1 text-right items-center">
                                <div class="text-gray-500 font-semibold text-sm">เลขที่เอกสาร:</div>
                                <div class="doc-id font-bold text-base text-gray-900 tracking-wide">BN-160126-001</div>
                                <div class="text-gray-500 font-semibold text-sm">วันที่:</div>
                                <div class="font-bold text-base text-gray-900">15 มกราคม 2569</div>
                            </div>
                        </div>
                    </div>

                    <!-- Info -->
                    <div class="mb-6">
                        <div class="p-4 bg-white rounded-lg border border-gray-300 shadow-sm relative overflow-hidden">
                            <div class="absolute left-0 top-0 bottom-0 w-1 bg-ci-500"></div>
                            <h4 class="text-xs font-bold text-gray-500 uppercase mb-3 border-b border-gray-200 pb-1 w-full tracking-wide pl-2">ลูกค้า / กลุ่ม (CUSTOMER / GROUP)</h4>
                            <div class="space-y-1.5 pl-3">
                                <p class="text-sm font-bold text-gray-900">คุณสมชาย ใจดี</p>
                                <div class="text-sm text-gray-600 space-y-1">
                                    <p class="flex items-start gap-2">
                                        <i class="fas fa-map-marker-alt text-gray-400 mt-1 w-4 text-center text-xs"></i>
                                        <span class="leading-snug">88/9 อาคารสมชายเพลส ชั้น 5 ถนนรัชดาภิเษก <br>แขวงดินแดง เขตดินแดง กรุงเทพมหานคร 10400</span>
                                    </p>
                                    <p class="flex items-center gap-2">
                                        <i class="fas fa-phone text-gray-400 w-4 text-center text-xs"></i>
                                        <span>089-123-4567</span>
                                    </p>
                                    <p class="flex items-center gap-2">
                                        <i class="fas fa-id-card text-gray-400 w-4 text-center text-xs"></i>
                                        <span>เลขประจำตัวผู้เสียภาษี: 1-2345-67890-12-3</span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="mb-6">
                        <table class="w-full border-collapse">
                            <thead>
                                <tr class="border-y-2 border-gray-700 text-gray-900 text-sm uppercase font-bold">
                                    <th class="py-3 px-4 text-center w-12">#</th>
                                    <th class="py-3 px-4 text-left">รายการ (Description)</th>
                                    <th class="py-3 px-4 text-center w-24">จำนวน</th>
                                    <th class="py-3 px-4 text-right w-32">ราคา/หน่วย</th>
                                    <th class="py-3 px-4 text-right w-32">จำนวนเงิน</th>
                                </tr>
                            </thead>
                            <tbody class="text-gray-700 text-sm">
                                <tr class="border-b border-gray-200 hover:bg-ci-50">
                                    <td class="py-4 px-4 text-center align-top font-medium text-gray-500">1</td>
                                    <td class="py-4 px-4 align-top">
                                        <p class="font-bold text-base text-gray-800 mb-1">เชียงใหม่-ฮ่องกง ดิสนีย์ 3 วัน 2 คืน จอง จ่าย จบ</p>
                                        <div class="text-xs text-gray-500 flex items-center gap-2">
                                            <i class="far fa-calendar-alt text-ci-500"></i>
                                            <span>เดินทาง: 7 มีนาคม 2569</span>
                                        </div>
                                    </td>
                                    <td class="py-4 px-4 text-center align-top text-gray-900 font-medium">2 ท่าน</td>
                                    <td class="py-4 px-4 text-right align-top text-gray-900 font-mono">26,888.00</td>
                                    <td class="py-4 px-4 text-right font-mono text-gray-900 align-top">53,776.00</td>
                                </tr>
                                <tr class="border-b border-gray-100 h-16">
                                    <td colspan="5"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Totals -->
                    <div class="mb-6 flex flex-col md:flex-row gap-6 items-end">
                        <div class="w-full md:w-3/5">
                            <div class="bg-ci-50 border border-ci-100 py-3 px-4 rounded text-center">
                                <span class="text-sm font-bold text-ci-800">( สองหมื่นสามพันเจ็ดร้อยเจ็ดสิบหกบาทถ้วน )</span>
                            </div>
                        </div>
                        <div class="w-full md:w-2/5">
                             <div class="space-y-2">
                                <div class="flex justify-between text-gray-600 text-sm">
                                    <span>ยอดรวมทั้งหมด (Total):</span>
                                    <span class="font-mono font-medium text-base">53,776.00</span>
                                </div>
                                <div class="flex justify-between text-red-500 text-sm">
                                    <span>หัก ชำระแล้ว (Paid):</span>
                                    <span class="font-mono font-medium text-base">-30,000.00</span>
                                </div>
                                <div class="border-t border-gray-300 my-1"></div>
                                <div class="flex justify-between items-center">
                                    <span class="font-bold text-gray-900 text-base">ยอดสุทธิ (Grand Total):</span>
                                    <span class="font-mono text-xl font-bold text-gray-900">฿23,776.00</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="border-b border-dashed border-gray-300 mb-6"></div>

                    <!-- Payment & Contact -->
                    <div class="mb-2 flex flex-col md:flex-row gap-6">
                        <div class="w-full md:w-1/2">
                            <!-- Billing Box -->
                            <div class="payment-box-billing border border-gray-300 rounded-lg p-5 h-full relative overflow-hidden bg-white">
                                <div class="absolute top-0 left-0 w-1 h-full bg-ci-500"></div>
                                <h5 class="font-bold text-gray-800 border-b border-gray-200 pb-2 mb-3 text-sm flex items-center gap-2">
                                    <i class="fas fa-university text-ci-600"></i> ข้อมูลการชำระเงิน
                                </h5>
                                <div class="text-sm text-gray-700 space-y-2 mb-4 pl-2">
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">ธนาคาร:</span> 
                                        <span class="font-semibold text-gray-900">กสิกรไทย (KBank)</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">เลขบัญชี:</span> 
                                        <span class="font-mono font-bold tracking-wider text-gray-900">123-4-56789-0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span class="text-gray-500">ชื่อบัญชี:</span> 
                                        <span class="text-gray-900">บจก. รุ่งอนันต์ ทัวร์</span>
                                    </div>
                                </div>
                                <div class="payment-deadline bg-red-50 rounded p-2 text-center border border-red-100">
                                    <p class="text-xs font-bold text-red-600">
                                        <i class="far fa-clock mr-1"></i> กรุณาชำระส่วนที่เหลือภายใน: <span class="text-sm underline">13 กุมภาพันธ์ 2569</span>
                                    </p>
                                </div>
                                <!-- Updated Text Here -->
                                <p class="text-[10px] text-gray-400 mt-2 text-center italic">* กรุณาแจ้งเจ้าหน้าที่ พร้อมส่งหลักฐานการชำระเงิน หลังจากชำระเงินเรียบร้อยแล้ว</p>
                            </div>

                            <!-- Receipt Box -->
                            <div class="payment-box-receipt hidden border border-gray-300 rounded-lg p-5 h-full relative overflow-hidden bg-white">
                                <div class="absolute top-0 left-0 w-1 h-full bg-ci-500"></div>
                                <h5 class="font-bold text-gray-800 border-b border-gray-200 pb-2 mb-3 text-sm flex items-center gap-2">
                                    <i class="fas fa-check-circle text-ci-600"></i> การชำระเงิน (Payment Method)
                                </h5>
                                <div class="text-sm text-gray-700 space-y-3 pl-2">
                                    <div class="flex items-center gap-3">
                                        <div class="checkbox-box"></div>
                                        <span>เงินสด (Cash)</span>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <div class="checkbox-box checked mt-0.5"><i class="fas fa-check text-[10px]"></i></div>
                                        <div class="w-full">
                                            <span class="font-semibold text-gray-900">เงินโอน (Bank Transfer)</span>
                                            <div class="mt-2 bg-gray-50 p-2 rounded border border-gray-200 text-xs text-gray-600 space-y-1">
                                                <p>ธนาคาร: <span class="font-medium text-gray-900">กสิกรไทย (KBank)</span></p>
                                                <p>เข้าบัญชีเลขที่: <span class="font-mono text-gray-900">123-4-56789-0</span></p>
                                                <div class="flex gap-4">
                                                    <p>วันที่: <span class="text-gray-900">06/02/2569</span></p>
                                                    <p>เวลา: <span class="text-gray-900">14:30</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Box -->
                        <div class="w-full md:w-1/2">
                            <div class="border border-gray-300 rounded-lg p-5 h-full relative overflow-hidden bg-white">
                                <div class="absolute top-0 left-0 w-1 h-full bg-ci-500"></div>
                                <h5 class="font-bold text-gray-800 border-b border-gray-200 pb-2 mb-3 text-sm flex items-center gap-2">
                                    <i class="fas fa-headset text-ci-600"></i> สอบถามข้อมูลเพิ่มเติม
                                </h5>
                                <div class="text-sm text-gray-700 space-y-3 pl-2">
                                    <div>
                                        <p class="text-gray-500 text-xs mb-0.5">สาขาที่ดูแล:</p>
                                        <p class="font-semibold text-gray-900">รุ่งอนันต์ทัวร์ สาขาฟ้าฮ่าม</p>
                                    </div>
                                    <div>
                                        <p class="text-gray-500 text-xs mb-0.5">เบอร์โทรศัพท์:</p>
                                        <p class="font-mono text-gray-900"><i class="fas fa-phone-alt text-gray-400 mr-1"></i>065-512-2155, 053-261-146</p>
                                    </div>
                                    <div>
                                        <p class="text-gray-500 text-xs mb-0.5">ฝ่ายขาย:</p>
                                        <p class="text-gray-900"><i class="fas fa-user text-gray-400 mr-1"></i>คุณวิภาดา (089-999-8888)</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer / Signature -->
                <div class="mt-auto pt-12 border-t border-gray-300">
                    <div class="flex justify-between px-4 w-full">
                        <div class="flex flex-col items-center w-72">
                            <p class="text-xs text-gray-500 mb-10 w-full text-left font-medium pl-2">ในนาม ลูกค้า / <span class="signer-role-customer-title">ผู้รับวางบิล</span>:</p>
                            <div class="w-full border-b border-dotted border-gray-400 mb-2 h-8"></div>
                            <p class="font-bold text-gray-800 text-sm tracking-wide">( ........................................................... )</p>
                            <p class="signer-role-customer text-xs text-gray-500 mt-1">ผู้รับวางบิล</p>
                            <div class="flex items-end mt-3 text-xs text-gray-500 w-full justify-center gap-2">
                                <span class="mb-1">วันที่:</span>
                                <div class="w-24 border-b border-dotted border-gray-400 mb-1.5"></div>
                            </div>
                        </div>

                        <div class="flex flex-col items-center w-72">
                            <p class="text-xs text-gray-500 mb-10 w-full text-right font-medium">ในนาม บจก. รุ่งอนันต์ ทัวร์:</p>
                            <div class="w-full border-b border-dotted border-gray-400 mb-2 h-8"></div>
                            <p class="font-bold text-gray-800 text-sm tracking-wide">( นางสาววิภาดา รักบริการ )</p>
                            <p class="signer-role-company text-xs text-gray-500 mt-1">ผู้วางบิล</p>
                            <div class="flex items-end mt-3 text-xs text-gray-500 w-full justify-center gap-2">
                                <span class="mb-1">วันที่:</span>
                                <div class="w-24 border-b border-dotted border-gray-400 mb-1.5"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- COPY PAGE CONTAINER -->
            <div id="copy-page-container"></div>

        </main>
    </div>

    <script>
        const docData = {
            'billing': {
                title: 'ใบวางบิล',
                id: 'BN-160126-001',
                customerRole: 'ผู้รับวางบิล',
                companyRole: 'ผู้วางบิล',
                mode: 'billing'
            },
            'voucher': {
                title: 'ใบสำคัญรับเงิน',
                id: 'RV-160126-001',
                customerRole: 'ผู้จ่ายเงิน',
                companyRole: 'ผู้รับเงิน',
                mode: 'receipt'
            },
            'receipt': {
                title: 'ใบเสร็จรับเงิน',
                id: 'RE-160126-001',
                customerRole: 'ผู้ชำระเงิน',
                companyRole: 'ผู้รับเงิน',
                mode: 'receipt'
            }
        };

        function updateContent(container, data) {
            container.querySelector('.doc-title').innerText = data.title;
            container.querySelector('.doc-id').innerText = data.id;
            
            container.querySelector('.signer-role-customer').innerText = data.customerRole;
            container.querySelector('.signer-role-customer-title').innerText = data.customerRole;
            container.querySelector('.signer-role-company').innerText = data.companyRole;

            const boxBilling = container.querySelector('.payment-box-billing');
            const boxReceipt = container.querySelector('.payment-box-receipt');

            if (data.mode === 'billing') {
                boxBilling.classList.remove('hidden');
                boxReceipt.classList.add('hidden');
            } else {
                boxBilling.classList.add('hidden');
                boxReceipt.classList.remove('hidden');
            }
        }

        function switchDoc(type) {
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));
            document.getElementById('btn-' + type).classList.add('active');

            const data = docData[type];
            document.title = 'Invoice-' + data.id;

            // 1. Update Master Page (Original)
            const masterPage = document.getElementById('master-page');
            updateContent(masterPage, data);

            // 2. Clone to create Copy Page
            const copyContainer = document.getElementById('copy-page-container');
            copyContainer.innerHTML = ''; // Clear previous copy

            const copyPage = masterPage.cloneNode(true);
            copyPage.id = 'copy-page'; 
            
            // Update Label to Copy (Must update inner text, not just append)
            const label = copyPage.querySelector('.doc-type-label');
            label.innerText = 'สำเนา (Copy)';
            // label.style.color = '#94a3b8'; // Optional styling for copy
            
            copyContainer.appendChild(copyPage);
        }

        window.onload = function() {
            switchDoc('billing');
        };

        function printDocument() {
            window.print();
        }
    </script>
</body>
</html>